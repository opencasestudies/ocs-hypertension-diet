family = quasibinomial(), design = hypertension_design)
summ(g1)
g2 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design)
#summ(g2)$coeftable[,1:2]
s <- data.frame('c'=exp(g2$coefficients[2:12]),
'n'=names(g2$coefficients)[2:12])
s <- s[order(s$c),]
l=seq(from=2, to=12, by=1)
plt<- ggplot(s,aes(x = l, y=c,col=s$c)) +
geom_point(size=5)+
scale_colour_gradient(low ='pink', high = 'darkred')+
geom_hline(yintercept = 1,col='pink',size=1.5,linetype=2)+
theme_bw() + theme(plot.title = element_text(hjust = 2,vjust=-2))+
geom_text_repel(aes(y = c,label=n),col='darkred')+
ggtitle("Effect on Hypertension") +
ylab("Feature Effects") +
xlab("Features")+
coord_flip()
plt
g3 <- glm(hypertension~ age+bmi+cholesterol+diabetes+gender+smoking+diet,
family = binomial(link = 'logit'),data = DF)
#summ(g3)$coeftable[,1:2]
plot_summs(g2, g3, scale = TRUE, model.names = c("svyglm", "glm"))
#ggsave("data/Finalplot.png", plot = last_plot(), device = "png")
N <-  6825749
n <- 1065
((N-n)/(N-1))^0.5
N <-  6825749
n <- 1065
((N-n)/(N-1))^0.5
hypertension_design <- svydesign(
id = ~1,
fpc = ~rep(N,n),
weights = ~DF$surveyweight,
data = DF[,-c(1,13)]
)
hypertension_design2 <- svydesign(
id = ~1,
fpc = ~rep(N,n),
strata = DF$gender,
data = DF[,-c(1,13)]
)
hypertension_design <- svydesign(
id = ~1,
fpc = ~rep(N,n),
weights = ~DF$surveyweight,
data = DF[,-c(1,13)]
)
hypertension_design2 <- svydesign(
id = ~1,
fpc = ~rep(N,n),
strata = DF$gender,
data = DF[,-c(1,13)]
)
hypertension_design$variables$hypertension <-
ifelse(hypertension_design$variables$hypertension == 'No', yes = 0, no =1)
hypertension_design2$variables$hypertension <-
ifelse(hypertension_design2$variables$hypertension == 'No', yes = 0, no =1)
g2 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design)
#summ(g2)$coeftable[,1:2]
g2 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design)
g2 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design2)
#summ(g2)$coeftable[,1:2]
g2 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design)
g22 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design2)
#summ(g2)$coeftable[,1:2]
plot_summs(g2, g22, scale = TRUE, model.names = c("svyglm", "glm"))
plot_summs(g2, g22, scale = TRUE)
#model.names = c("svyglm", "glm"))
g3 <- glm(hypertension~ age+bmi+cholesterol+diabetes+gender+smoking+diet,
family = binomial(link = 'logit'),data = DF)
#summ(g3)$coeftable[,1:2]
plot_summs(g2, g22, g3,scale = TRUE)
#model.names = c("svyglm", "glm"))
plot_summs(g2, g22, g3)
#model.names = c("svyglm", "glm"))
plot_summs(g2, g22, g3,scale = TRUE)
#model.names = c("svyglm", "glm"))
knitr::opts_chunk$set(echo = TRUE,message = FALSE,warning = FALSE)
p2 <- ggplot(DF, aes(y = hypertension, x=gender))+
geom_boxplot()+ggtitle('distribution of gender')
knitr::opts_chunk$set(echo = TRUE,message = FALSE,warning = FALSE)
library(knitr)
library(ggplot2)
library(ggpubr)
library(ggrepel)
library(tableone)
library(kableExtra)
library(survey)
library(broom)
library(Rmisc)
library(tidyverse)
library(haven)
library(jtools)
library(plotrix)
dat <- read_sas('./data/dat.sas7bdat')
hypertension_DF <- dat %>%
select(
id = KEY,
age = SPAGE,
race = DMQ_14_1,
gender = GENDER,
diet = DBQ_1,
income = INC20K,
diabetes = DX_DBTS,
bmi = BMI,
cholesterol = BPQ_16,
drink = ALQ_1_UNIT,
smoking = SMOKER3CAT,
hypertension = BPQ_2,
surveyweight = CAPI_WT
)
summary(hypertension_DF)
table(dat$ALQ_1)
hypertension_DF$drink[which(dat$ALQ_1==0)] <- 4
summary(hypertension_DF$drink)
DF <- hypertension_DF %>%
drop_na()
DF$race <- factor(DF$race, levels=c(100, 110, 120, 140, 180, 250),
labels=c('White', 'Black/African American',
'Indian /Alaska Native',
'Pacific Islander', 'Asian', 'Other Race'))
DF$gender <-  factor(DF$gender, levels=c(1,2),
labels=c('Male', 'Female'))
DF$diet <-  factor(DF$diet, levels=c(5:1),
labels=c('Poor', 'Fair', 'Good', 'Very good','Excellent'))
DF$income <-  factor(DF$income, levels=c(1:6),
labels=c('Less than $20,000','$20,000 - $39,999',
'$40,000 - $59,999','$60,000 - $79,999',
'$80,000 - $99,999','$100,000 or more'))
DF$diabetes <-  factor(DF$diabetes, levels=c(3,1,2),
labels=c('Not diabetic','Diabetic dx','Diabetic but no dx'))
DF$cholesterol <-  factor(DF$cholesterol, levels=c(2,1),
labels=c('Low value','High value'))
DF$drink <-  factor(DF$drink, levels=c(4,1,2,3),
labels=c('Never','Weekly', 'Monthly', 'Yearly'))
DF$smoking <-  factor(DF$smoking, levels=c(3:1),
labels=c('Never smoker','Former smoker','Current smoker'))
DF$hypertension <-  factor(DF$hypertension, levels=c(2,1),
labels=c('No','Yes'))
p1 <- ggplot(DF, aes(x = hypertension, y=age))+
geom_boxplot()+ggtitle('distribution of age')
p1
p2 <- ggplot(DF, aes(y = hypertension, x=gender))+
geom_boxplot()+ggtitle('distribution of gender')
p3 <- ggplot(DF, aes(x = gender, fill = hypertension)) +
geom_bar()+ggtitle('distribution of gender')
p4 <- ggplot(DF, aes(x = gender, fill = hypertension)) +
geom_bar(position = "fill")+ggtitle('distribution of gender') + ylab('proportion')
ggarrange(p2,p3,p4,ncol=3,nrow=1)
p2 <- ggplot(DF, aes(y = hypertension, x=gender))+
geom_boxplot()+ggtitle('distribution of hypertension')
p3 <- ggplot(DF, aes(x = gender, fill = hypertension)) +
geom_bar()+ggtitle('distribution of hypertension')
p4 <- ggplot(DF, aes(x = gender, fill = hypertension)) +
geom_bar(position = "fill")+ggtitle('distribution of hypertension') + ylab('proportion')
ggarrange(p2,p3,p4,ncol=3,nrow=1)
p1 <- ggplot(DF, aes(y = hypertension, x=age))+
geom_boxplot()+ggtitle('distribution of hypertension')
p1
p1 <- ggplot(DF, aes(x = hypertension, y=age))+
geom_boxplot()+ggtitle('distribution of age')
p1
p2 <- ggplot(DF, aes(x = hypertension, y=gender))+
geom_boxplot()+ggtitle('distribution of gender')
p3 <- ggplot(DF, aes(x = gender, fill = hypertension)) +
geom_bar()+ggtitle('distribution of hypertension')
p4 <- ggplot(DF, aes(x = gender, fill = hypertension)) +
geom_bar(position = "fill")+ggtitle('distribution of hypertension') + ylab('proportion')
ggarrange(p2,p3,p4,ncol=3,nrow=1)
plot_summs(g2, g22, g3,coefs = c('age'='age','Bmi=bmi'))
plot_summs(g2, g22, g3,coefs = c('age'='age','Bmi'='bmi'))
plot_summs(g2, g22, g3,coefs = c('age'='age','bmi'='bmi','cholesterol'='cholesterol','diabetic with dignosis'='diabetesDiabetic dx'))
plot_summs(g2, g22, g3,coefs = c('age'='age','bmi'='bmi','cholesterol'='cholesterol','diabetic with dignosis'='diabetesDiabetic dx'))
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi','cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx'))
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx'))
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx'),
'cholesterol'='cholesterol')
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx','cholesterol'='cholesterol')
)
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi', 'gender'='gender'
'diabetic with dignosis'='diabetesDiabetic dx',
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi', 'gender'='gender',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx','cholesterol'='cholesterol')
)
g2 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design)
g22 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design2)
#summ(g2)$coeftable[,1:2]
s <- data.frame('c'=exp(g2$coefficients[2:12]),
'n'=names(g2$coefficients)[2:12])
s <- s[order(s$c),]
l=seq(from=2, to=12, by=1)
plt<- ggplot(s,aes(x = l, y=c,col=s$c)) +
geom_point(size=5)+
scale_colour_gradient(low ='pink', high = 'darkred')+
geom_hline(yintercept = 1,col='pink',size=1.5,linetype=2)+
theme_bw() + theme(plot.title = element_text(hjust = 2,vjust=-2))+
geom_text_repel(aes(y = c,label=n),col='darkred')+
ggtitle("Effect on Hypertension") +
ylab("Feature Effects") +
xlab("Features")+
coord_flip()
plt
g3 <- glm(hypertension~ age+bmi+cholesterol+diabetes+gender+smoking+diet,
family = binomial(link = 'logit'),data = DF)
#summ(g3)$coeftable[,1:2]
plot_summs(g2, g22, g3,scale = TRUE)
#model.names = c("svyglm", "glm"))
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi', 'gender'='gender',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'cholesterol'='cholesterol','fair diet'='dietFair')
)
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi', 'gender'='gender',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'cholesterol'='cholesterol','fair diet'='dietFair'),
scale=TRUE)
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
scale=TRUE)
plot_summs(g2, g22, g3,scale = TRUE, model.names = c("svyglm", "glm"))
plot_summs(g2, g3,scale = TRUE, model.names = c("svyglm", "glm"))
plot_summs(g2, g22, g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
scale=TRUE)
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
scale=TRUE)
plot_summs(g2, g3,scale = TRUE, model.names = c("svyglm", "glm"))
ggsave("data/Finalplot.png", plot = last_plot(), device = "png")
knitr::opts_chunk$set(echo = TRUE,message = FALSE,warning = FALSE)
knitr::opts_chunk$set(echo = TRUE,message = FALSE,warning = FALSE)
library(knitr)
library(ggplot2)
library(ggpubr)
library(ggrepel)
library(tableone)
library(kableExtra)
library(survey)
library(broom)
library(Rmisc)
library(tidyverse)
library(haven)
library(jtools)
library(plotrix)
dat <- read_sas('./data/dat.sas7bdat')
hypertension_DF <- dat %>%
select(
id = KEY,
age = SPAGE,
race = DMQ_14_1,
gender = GENDER,
diet = DBQ_1,
income = INC20K,
diabetes = DX_DBTS,
bmi = BMI,
cholesterol = BPQ_16,
drink = ALQ_1_UNIT,
smoking = SMOKER3CAT,
hypertension = BPQ_2,
surveyweight = CAPI_WT
)
summary(hypertension_DF)
table(dat$ALQ_1)
hypertension_DF$drink[which(dat$ALQ_1==0)] <- 4
summary(hypertension_DF$drink)
DF <- hypertension_DF %>%
drop_na()
DF$race <- factor(DF$race, levels=c(100, 110, 120, 140, 180, 250),
labels=c('White', 'Black/African American',
'Indian /Alaska Native',
'Pacific Islander', 'Asian', 'Other Race'))
DF$gender <-  factor(DF$gender, levels=c(1,2),
labels=c('Male', 'Female'))
DF$diet <-  factor(DF$diet, levels=c(5:1),
labels=c('Poor', 'Fair', 'Good', 'Very good','Excellent'))
DF$income <-  factor(DF$income, levels=c(1:6),
labels=c('Less than $20,000','$20,000 - $39,999',
'$40,000 - $59,999','$60,000 - $79,999',
'$80,000 - $99,999','$100,000 or more'))
DF$diabetes <-  factor(DF$diabetes, levels=c(3,1,2),
labels=c('Not diabetic','Diabetic dx','Diabetic but no dx'))
DF$cholesterol <-  factor(DF$cholesterol, levels=c(2,1),
labels=c('Low value','High value'))
DF$drink <-  factor(DF$drink, levels=c(4,1,2,3),
labels=c('Never','Weekly', 'Monthly', 'Yearly'))
DF$smoking <-  factor(DF$smoking, levels=c(3:1),
labels=c('Never smoker','Former smoker','Current smoker'))
DF$hypertension <-  factor(DF$hypertension, levels=c(2,1),
labels=c('No','Yes'))
summary(DF)
p1 <- ggplot(DF, aes(x = hypertension, y=age))+
geom_boxplot()+ggtitle('distribution of age')
p1
p2 <- ggplot(DF, aes(x = hypertension, y=gender))+
geom_boxplot()+ggtitle('distribution of gender')
p3 <- ggplot(DF, aes(x = gender, fill = hypertension)) +
geom_bar()+ggtitle('distribution of hypertension')
p4 <- ggplot(DF, aes(x = gender, fill = hypertension)) +
geom_bar(position = "fill")+ggtitle('distribution of hypertension') + ylab('proportion')
ggarrange(p2,p3,p4,ncol=3,nrow=1)
N <-  6825749
n <- 1065
((N-n)/(N-1))^0.5
hypertension_design <- svydesign(
id = ~1,
#fpc = ~rep(N,n),
weights = ~DF$surveyweight,
data = DF[,-c(1,13)]
)
hypertension_design2 <- svydesign(
id = ~1,
fpc = ~rep(N,n),
#strata = DF$gender,
data = DF[,-c(1,13)]
)
summary(hypertension_design)
svymean(~bmi, hypertension_design)
mean(DF$bmi)
std.error(DF$bmi)
confint(svymean(~bmi, hypertension_design))
svyby(~bmi, by=~diet, design=hypertension_design, FUN = svymean)
svymean(~bmi, subset(hypertension_design,gender=="Female"))
svymean(~bmi, subset(hypertension_design,gender=="Male"))
hypertension_design$variables$hypertension <-
ifelse(hypertension_design$variables$hypertension == 'No', yes = 0, no =1)
g1 <- svyglm(hypertension ~
age+race+gender+diet+income+diabetes+bmi+cholesterol+drink+smoking,
family = quasibinomial(), design = hypertension_design)
summ(g1)
g2 <- svyglm(hypertension ~
age+bmi+cholesterol+diabetes+gender+smoking+diet,
family=binomial(), design = hypertension_design)
#summ(g2)$coeftable[,1:2]
s <- data.frame('c'=exp(g2$coefficients[2:12]),
'n'=names(g2$coefficients)[2:12])
s <- s[order(s$c),]
l=seq(from=2, to=12, by=1)
plt<- ggplot(s,aes(x = l, y=c,col=s$c)) +
geom_point(size=5)+
scale_colour_gradient(low ='pink', high = 'darkred')+
geom_hline(yintercept = 1,col='pink',size=1.5,linetype=2)+
theme_bw() + theme(plot.title = element_text(hjust = 2,vjust=-2))+
geom_text_repel(aes(y = c,label=n),col='darkred')+
ggtitle("Effect on Hypertension") +
ylab("Feature Effects") +
xlab("Features")+
coord_flip()
plt
g3 <- glm(hypertension~ age+bmi+cholesterol+diabetes+gender+smoking+diet,
family = binomial(link = 'logit'),data = DF)
#summ(g3)$coeftable[,1:2]
plot_summs(g2, g3,scale = TRUE, model.names = c("svyglm", "glm"))
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
scale=TRUE)
ggsave("data/Finalplot.png", plot = last_plot(), device = "png")
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE)
ggsave("data/Finalplot.png", plot = last_plot(), device = "png")
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE)
xaxis(at=1:4, labels=LETTERS[1:4])
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE)
axis(at=1:4, labels=LETTERS[1:4])
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE)
axis(side=1, at=1:4, labels=LETTERS[1:4])
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE)
+axis(side=1, at=1:4, labels=LETTERS[1:4])
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE)
+ axis(side=1, at=1:4, labels=LETTERS[1:4])
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE, xlab='2')
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE, xlab = 55)
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE)+ xlab('ci')
plot_summs(g2,g3,
coefs = c('age'='age','bmi'='bmi', 'cholesterol'='cholesterol',
'diabetic with dignosis'='diabetesDiabetic dx',
'diabetic without dignosis'='diabetesDiabetic but no dx',
'gender'='gender','former smoker'='smokingFormer smoker',
'current smoker'='smokingCurrent smoker',
'fair diet'='dietFair','good diet'='dietGood',
'very good diet'='dietVery good','excellent diet'='dietExcellent'),
model.names = c("svyglm", "glm"), scale=TRUE)+ xlab('confidence interval')
ggsave("data/Finalplot.png", plot = last_plot(), device = "png")
